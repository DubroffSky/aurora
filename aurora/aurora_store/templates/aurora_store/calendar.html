{% extends 'aurora_store/base.html' %}

{% block title %}Calendar - TaskFlow{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h3 class="card-title">Calendar - {{ current_month }}</h3>
                <div>
                    <a href="{% url 'aurora_store:task_create' %}" class="btn btn-primary">Add Task</a>
                    <a href="{% url 'aurora_store:tasks_list' %}" class="btn btn-outline-secondary">View All Tasks</a>
                </div>
            </div>
            <div class="card-body">
                <div id="calendar"></div>
            </div>
        </div>
    </div>
</div>

<style>
    .fc-event {
        cursor: pointer;
    }
    .priority-urgent { background-color: #dc3545 !important; border-color: #dc3545 !important; }
    .priority-high { background-color: #fd7e14 !important; border-color: #fd7e14 !important; }
    .priority-medium { background-color: #ffc107 !important; border-color: #ffc107 !important; color: #212529 !important; }
    .priority-low { background-color: #6c757d !important; border-color: #6c757d !important; }
    .status-completed { opacity: 0.6; }
    .status-in_progress { border-width: 2px !important; }
    .status-review { border-style: dashed !important; }
</style>

<link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay'
        },
        events: '{% url "aurora_store:calendar_events" %}',
        eventClick: function(info) {
            if (info.event.url) {
                window.location.href = info.event.url;
                return false;
            }
        },
        eventDidMount: function(info) {
            // Добавляем тултип с информацией о задаче
            $(info.el).tooltip({
                title: info.event.title,
                placement: 'top',
                trigger: 'hover',
                container: 'body'
            });
        }
    });
    calendar.render();
});
</script>
{% endblock %} 